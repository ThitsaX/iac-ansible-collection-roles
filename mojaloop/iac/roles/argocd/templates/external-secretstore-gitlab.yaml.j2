---
apiVersion: v1
kind: Secret
metadata:
  name: gitlab-secret
  namespace: {{ external_secrets_namespace }}
  labels: 
    type: gitlab
type: Opaque 
stringData:
  token: "{{ repo_password }}"
---
apiVersion: external-secrets.io/v1beta1
kind: ClusterSecretStore
metadata:
  name: gitlab-secret-store
spec:
  provider:
    # provider type: gitlab
    gitlab:
      url: {{ gitlab_server_url }}
      auth:
        SecretRef:
          accessToken:
            name: gitlab-secret
            namespace: {{ external_secrets_namespace }}
            key: token
      projectID: "{{ gitlab_project_id }}"
      inheritFromGroups: true
